<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Tri √Çn Th·∫ßy C√¥ 20/11</title>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;700&family=Patrick+Hand&display=swap" rel="stylesheet">
    <style>
        :root {
            --paper-color: #fdfbf0;
            --book-width: 850px;
            --book-height: 550px;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            -webkit-tap-highlight-color: transparent; /* B·ªè highlight khi ch·∫°m tr√™n mobile */
        }

        body {
            background-color: #1a1a1a;
            background-image: radial-gradient(circle, #2c3e50 0%, #000000 100%);
            height: 100vh; /* Fallback */
            height: 100dvh; /* Dynamic Viewport Height cho mobile (fix l·ªói thanh ƒë·ªãa ch·ªâ) */
            width: 100vw;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            font-family: 'Patrick Hand', cursive;
        }

        /* --- CANVAS & FALLING --- */
        #fireworks-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            pointer-events: none;
        }

        #falling-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 100;
            overflow: hidden;
        }

        .falling-item {
            position: absolute;
            top: -50px;
            user-select: none;
            animation-name: fall;
            animation-timing-function: linear;
        }

        @keyframes fall {
            to { transform: translateY(110vh) rotate(720deg); }
        }

        /* --- S√ÅCH ƒê√ìNG (Mobile Optimized) --- */
        .closed-book-wrapper {
            position: absolute;
            z-index: 50;
            transition: transform 0.8s ease, opacity 0.8s ease;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* Hi·ªáu ·ª©ng nh·ªãp ƒë·∫≠p nh·∫π ƒë·ªÉ m·ªùi g·ªçi */
        .closed-book-wrapper {
            animation: pulseBook 2s infinite ease-in-out;
        }
        
        @keyframes pulseBook {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }

        .closed-book {
            width: 240px; /* Nh·ªè h∆°n cho mobile */
            height: 360px;
            background: #F33139;
            border-radius: 15px 10px 8px 20px;
            background-image: linear-gradient(to right, #D11F2F 30px, #ba0716 32px, transparent 32px);
            box-shadow: 8px 15px 25px rgba(0,0,0,0.6);
            position: relative;
        }

        .closed-book::after { /* Gi·∫•y tr·∫Øng b√™n d∆∞·ªõi */
            content: "";
            position: absolute;
            height: 40px;
            width: 235px; 
            bottom: 4px;
            right: 0px;
            background: white;
            border-radius: 20px 4px 4px 20px;
            z-index: -1;
            background-image: repeating-linear-gradient(to right, #E4E0CE 0px, #E4E0CE 1px, transparent 1px, transparent 4px);
        }

        .book-title {
            position: absolute;
            top: 40%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(-5deg);
            width: 100%;
            text-align: center;
            color: #fdfbf0;
            font-family: 'Dancing Script', cursive;
            font-size: 3em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .click-hint {
            margin-top: 20px;
            color: white;
            font-size: 1.2em;
            opacity: 0.8;
            animation: fadeHint 1.5s infinite;
            text-align: center;
        }

        @keyframes fadeHint {
            0%, 100% { opacity: 0.4; }
            50% { opacity: 1; }
        }

        /* --- S√ÅCH M·ªû (Responsive Logic) --- */
        .opened-book-wrapper {
            display: none;
            opacity: 0;
            transition: opacity 0.8s ease-in;
            z-index: 10;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .book {
            width: var(--book-width);
            height: var(--book-height);
            display: flex;
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
            transition: all 0.5s;
        }

        .page {
            width: 50%;
            height: 100%;
            background-color: var(--paper-color);
            position: relative;
            padding: 30px;
            /* Texture gi·∫•y */
            background-image: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.08'/%3E%3C/svg%3E");
        }

        /* PC View */
        .page.left {
            border-radius: 10px 0 0 10px;
            background: linear-gradient(to right, #e6d8be, #fdfbf0 10%);
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .page.right {
            border-radius: 0 10px 10px 0;
            background: linear-gradient(to left, #e6d8be, #fdfbf0 10%);
            color: #5d4037;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            overflow: hidden; /* Ch·∫∑n cu·ªôn */
        }

        /* N·ªôi dung b√™n trong */
        .flower-img {
            width: 85%;
            height: 70%;
            object-fit: cover;
            border: 4px solid white;
            box-shadow: 3px 3px 10px rgba(0,0,0,0.2);
            transform: rotate(-3deg);
            background-image: url('https://banner2.cleanpng.com/20240104/pvp/transparent-cartoon-flowers-bouquet-colorful-roses-colorful-bouquet-of-roses-sunflowers-and-1710939838857.webp'); 
            background-size: cover;
            background-position: center;
            filter: sepia(20%);
        }

        .tape {
            position: absolute;
            top: 15px;
            left: 50%;
            transform: translateX(-50%) rotate(2deg);
            width: 80px;
            height: 25px;
            background-color: rgba(255, 255, 255, 0.5);
            z-index: 2;
        }

        .content {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: space-around; /* Ph√¢n b·ªë ƒë·ªÅu theo chi·ªÅu d·ªçc */
            padding: 10px 0;
        }

        .content h1 {
            font-family: 'Dancing Script', cursive;
            font-size: clamp(1.5rem, 4vw, 3rem); /* T·ª± ƒë·ªông scale ch·ªØ */
            color: #c0392b;
            line-height: 1.2;
            margin-bottom: 5px;
        }

        .content p {
            font-size: clamp(0.9rem, 2.5vw, 1.3rem); /* Ch·ªØ t·ª± nh·ªè l·∫°i n·∫øu m√†n h√¨nh b√© */
            line-height: 1.4;
            text-align: justify;
            margin: 5px 0;
        }

        .signature {
            text-align: right;
            font-family: 'Dancing Script', cursive;
            font-size: clamp(1.2rem, 3vw, 1.8rem);
            color: #2c3e50;
            margin-top: 5px;
        }

        /* --- MOBILE OPTIMIZATION (C·ª±c k·ª≥ quan tr·ªçng) --- */
        @media (max-width: 850px) {
            .opened-book-wrapper {
                display: none; /* Gi·ªØ logic ·∫©n hi·ªán */
            }

            .book {
                width: 92vw;
                height: 85vh; /* Chi·∫øm 85% chi·ªÅu cao m√†n h√¨nh */
                flex-direction: column; /* X·∫øp d·ªçc: ·∫¢nh tr√™n, L·ªùi ch√∫c d∆∞·ªõi */
                box-shadow: 0 10px 30px rgba(0,0,0,0.6);
            }

            .page {
                width: 100%;
                height: 50%; /* Chia ƒë√¥i m√†n h√¨nh */
                padding: 20px;
            }

            /* Trang tr√™n (·∫¢nh) */
            .page.left {
                border-radius: 10px 10px 0 0;
                background: linear-gradient(to bottom, #e6d8be, #fdfbf0 15%);
                border-right: none;
                border-bottom: 1px solid rgba(139, 69, 19, 0.1);
            }

            /* Trang d∆∞·ªõi (Ch·ªØ) */
            .page.right {
                border-radius: 0 0 10px 10px;
                background: linear-gradient(to top, #e6d8be, #fdfbf0 15%);
                border-left: none;
            }

            .flower-img {
                width: auto;
                height: 85%; /* ·∫¢nh cao h∆°n ch√∫t tr√™n mobile */
                max-width: 90%;
            }

            .content {
                justify-content: center;
                gap: 10px;
            }

            /* Tinh ch·ªânh ch·ªØ tr√™n mobile */
            .content h1 {
                font-size: 6.5vmin; /* D·ª±a tr√™n c·∫°nh nh·ªè nh·∫•t c·ªßa m√†n h√¨nh */
            }
            
            .content p {
                font-size: 4vmin;
                line-height: 1.5;
            }

            .signature {
                font-size: 5vmin;
                margin-top: 10px;
            }
        }
    </style>
</head>
<body>

    <canvas id="fireworks-canvas"></canvas>
    <div id="falling-container"></div>

    <audio id="bg-music" loop>
        <!-- D√πng link nh·∫°c ·ªïn ƒë·ªãnh h∆°n -->
        <source src="https://cdn.pixabay.com/audio/2024/06/05/audio_116f29598b.mp3" type="audio/mpeg">
    </audio>

    <!-- S√°ch ƒê√≥ng -->
    <div class="closed-book-wrapper" id="closed-book-trigger">
        <div class="closed-book">
            <div class="book-title">Tri √Çn<br>20-11</div>
        </div>
        <div class="click-hint">Cham nh·∫π ƒë·ªÉ m·ªü üëÜ</div>
    </div>

    <!-- S√°ch M·ªü -->
    <div class="opened-book-wrapper" id="opened-book-view">
        <div class="book">
            <div class="page left">
                <div class="tape"></div>
                <div class="flower-img"></div>
            </div>
            <div class="page right">
                <div class="content">
                    <h1>K√≠nh G·ª≠i Th·∫ßy C√¥</h1>
                    <p>
                        Nh√¢n ng√†y Nh√† gi√°o Vi·ªát Nam 20/11, em xin g·ª≠i ƒë·∫øn Th·∫ßy,C√¥ l·ªùi tri √¢n s√¢u s·∫Øc nh·∫•t. C·∫£m ∆°n Th·∫ßy,C√¥ v√¨ ƒë√£ lu√¥n t·∫≠n t·ª•y, ki√™n nh·∫´n d√¨u d·∫Øt ch√∫ng em n√™n ng∆∞·ªùi.
                    </p>
                    <p>
                        K√≠nh ch√∫c Th·∫ßy,C√¥ lu√¥n m·∫°nh kh·ªèe, h·∫°nh ph√∫c v√† gi·ªØ m√£i ng·ªçn l·ª≠a ƒëam m√™ v·ªõi s·ª± nghi·ªáp tr·ªìng ng∆∞·ªùi cao qu√Ω. Nh·ªØng b√†i h·ªçc ng√†y ·∫•y m√£i l√† h√†nh trang qu√Ω gi√° theo em su·ªët cu·ªôc ƒë·ªùi.
                    </p>
                    <div class="signature">
                        H·ªçc tr√≤,<br>
                        K23418
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const closedBook = document.getElementById('closed-book-trigger');
        const openedBook = document.getElementById('opened-book-view');
        const music = document.getElementById('bg-music');
        const fallingContainer = document.getElementById('falling-container');
        const canvas = document.getElementById('fireworks-canvas');
        const ctx = canvas.getContext('2d');

        // Detect Mobile
        const isMobile = window.innerWidth < 850;

        // --- PH·∫¶N 1: CANVAS PH√ÅO HOA (T·ªëi ∆∞u hi·ªáu nƒÉng) ---
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        class Particle {
            constructor(x, y, color) {
                this.x = x;
                this.y = y;
                this.color = color;
                const angle = Math.random() * Math.PI * 2;
                // Gi·∫£m t·ªëc ƒë·ªô n·ªï tr√™n mobile cho g·ªçn
                const velocity = isMobile ? Math.random() * 3 + 1 : Math.random() * 4 + 1;
                this.vx = Math.cos(angle) * velocity;
                this.vy = Math.sin(angle) * velocity;
                this.alpha = 1;
                this.decay = isMobile ? 0.02 : 0.015; // M·ªù nhanh h∆°n tr√™n mobile
            }

            update() {
                this.x += this.vx;
                this.y += this.vy;
                this.vy += 0.05;
                this.alpha -= this.decay;
            }

            draw(ctx) {
                ctx.save();
                ctx.globalAlpha = this.alpha;
                ctx.beginPath();
                ctx.arc(this.x, this.y, isMobile ? 1.5 : 2, 0, Math.PI * 2);
                ctx.fillStyle = this.color;
                ctx.fill();
                ctx.restore();
            }
        }

        let particles = [];
        const colors = ['#FF5733', '#FFC300', '#DAF7A6', '#FF33F6', '#33FFF6'];

        function createFirework(x, y) {
            // Gi·∫£m s·ªë l∆∞·ª£ng h·∫°t tr√™n mobile ƒë·ªÉ ƒë·ª° lag
            const count = isMobile ? 30 : 80; 
            const color = colors[Math.floor(Math.random() * colors.length)];
            for (let i = 0; i < count; i++) {
                particles.push(new Particle(x, y, color));
            }
        }

        function animateFireworks() {
            ctx.fillStyle = 'rgba(0, 0, 0, 0.15)'; // X√≥a v·∫øt m·ªù nhanh h∆°n
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            for (let i = particles.length - 1; i >= 0; i--) {
                const p = particles[i];
                p.update();
                p.draw(ctx);
                if (p.alpha <= 0) particles.splice(i, 1);
            }
            requestAnimationFrame(animateFireworks);
        }

        // --- PH·∫¶N 2: HOA R∆†I ---
        const fallingItems = ['', '', '', '', '']; 
        function createFallingItem() {
            const item = document.createElement('div');
            item.classList.add('falling-item');
            item.innerText = fallingItems[Math.floor(Math.random() * fallingItems.length)];
            item.style.left = Math.random() * 100 + 'vw';
            const size = Math.random() * 15 + 10;
            item.style.fontSize = size + 'px';
            const duration = Math.random() * 3 + 4;
            item.style.animationDuration = duration + 's';
            fallingContainer.appendChild(item);
            setTimeout(() => { item.remove(); }, duration * 1000);
        }

        // --- LOGIC CH√çNH ---
        closedBook.addEventListener('click', () => {
            music.volume = 0.6;
            music.play().catch(() => {});

            // Hi·ªáu ·ª©ng bi·∫øn m·∫•t
            closedBook.style.transform = isMobile ? "scale(1.2)" : "scale(1.5)";
            closedBook.style.opacity = "0";

            setTimeout(() => {
                closedBook.style.display = 'none';
                
                // Hi·ªán s√°ch m·ªü
                openedBook.style.display = 'flex'; // D√πng flex ƒë·ªÉ cƒÉn gi·ªØa
                
                // Animation m·ªü s√°ch
                requestAnimationFrame(() => {
                    openedBook.style.opacity = '1';
                });

                // B·∫Øt ƒë·∫ßu hi·ªáu ·ª©ng
                setInterval(createFallingItem, isMobile ? 600 : 400); // Mobile r∆°i √≠t h∆°n
                animateFireworks();
                
                // Ph√°o hoa t·ª± ƒë·ªông
                setInterval(() => {
                    if (openedBook.style.opacity === '1') {
                        const x = Math.random() * canvas.width;
                        const y = Math.random() * (canvas.height / 2);
                        createFirework(x, y);
                    }
                }, isMobile ? 1200 : 800); // Mobile b·∫Øn ch·∫≠m h∆°n

            }, 600);
        });

        // Fix resize tr√™n mobile
        window.addEventListener('resize', () => {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        });

    </script>
</body>
</html>
